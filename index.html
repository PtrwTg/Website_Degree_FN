<!DOCTYPE html>
<html lang="th"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
<script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: '#6d28d9',
                        'background-light': '#f5f3ff',
                        'background-dark': '#1e1b4b',
                        'card-light': '#ffffff',
                        'card-dark': '#312e81',
                        'text-light': '#4c1d95',
                        'text-dark': '#e0e7ff',
                        'subtext-light': '#5b21b6',
                        'subtext-dark': '#c7d2fe',
                    },
                    fontFamily: {
                        display: ['Sarabun', 'sans-serif'],
                    },
                    borderRadius: {
                        'DEFAULT': '1rem',
                        'lg': '1.5rem',
                        'xl': '2rem',
                    },
                },
            },
        };
    </script>
<style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
    </style>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body class="bg-background-light dark:bg-background-dark min-h-screen flex items-start justify-center p-4 sm:p-6">
<div class="container bg-card-light dark:bg-card-dark p-6 sm:p-8 rounded-lg shadow-2xl max-w-2xl w-full text-center border-t-8 border-primary animate-fadeInContainer">
<h1 class="text-3xl sm:text-4xl font-bold text-text-light dark:text-text-dark flex items-center justify-center gap-3">
<i class="material-icons text-primary text-4xl">celebration</i>
            ‡πÄ‡∏ä‡∏¥‡∏ç‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏Ñ‡πâ‡∏≤‡∏ö!
        </h1>
<p class="text-subtext-light dark:text-subtext-dark mt-2 mb-6">
            ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡πâ‡∏≤ üòä
        </p>
<div class="bg-primary/10 dark:bg-primary/20 p-4 mb-6 rounded-lg border border-primary/20" id="user-info" style="display: none;">
<p class="text-text-light dark:text-text-dark">üëã ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö: <strong class="font-semibold" id="user-name">-</strong></p>
<p class="text-xs text-subtext-light dark:text-subtext-dark mt-1">*‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
</div>
<form class="space-y-6 text-left" id="registration-form">
<div>
<label class="flex items-center gap-2 font-semibold text-text-light dark:text-text-dark mb-2" for="date">
<i class="material-icons">calendar_month</i>
                    ‡∏à‡∏∞‡∏°‡∏≤‡∏ß‡∏±‡∏ô‡πÑ‡∏´‡∏ô‡πÄ‡∏≠‡πà‡∏¢?
                </label>
<select class="w-full rounded-md border-gray-300 dark:border-indigo-900 bg-white dark:bg-indigo-900/50 text-gray-700 dark:text-indigo-200 focus:border-primary focus:ring-primary" id="date" name="date" required="">
<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏°‡∏≤‡πÄ‡∏•‡∏¢‡∏à‡πâ‡∏≤ --</option>
<option value="3-oct">‡∏ß‡∏±‡∏ô‡∏ã‡πâ‡∏≠‡∏°: ‡∏®‡∏∏‡∏Å‡∏£‡πå‡∏ó‡∏µ‡πà 3 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° (07:00 - 20:00)</option>
<option value="7-oct">‡∏ß‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á: ‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£‡∏ó‡∏µ‡πà 7 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° (08:00 ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ)</option>
</select>
</div>
<div class="rounded-lg p-4" id="schedule-display" style="display: none;"></div>
<div id="arrival-time-group" style="display: none;">
<label class="flex items-center gap-2 font-semibold text-text-light dark:text-text-dark mb-2" for="arrival_time">
<i class="material-icons">schedule</i>
                    ‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏µ‡πà‡πÇ‡∏°‡∏á?
                </label>
<input class="w-full rounded-md border-gray-300 dark:border-indigo-900 bg-white dark:bg-indigo-900/50 text-gray-700 dark:text-indigo-200 focus:border-primary focus:ring-primary" id="arrival_time" name="arrival_time" required="" type="time"/>
</div>
<div>
<label class="flex items-center gap-2 font-semibold text-text-light dark:text-text-dark mb-2" for="first_name">
<i class="material-icons">person</i>
                    ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á:
                </label>
<input class="w-full rounded-md border-gray-300 dark:border-indigo-900 bg-white dark:bg-indigo-900/50 text-gray-700 dark:text-indigo-200 focus:border-primary focus:ring-primary" id="first_name" name="first_name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏∏‡∏î‡∏´‡∏•‡πà‡∏≠" required="" type="text"/>
</div>
<div>
<label class="flex items-center gap-2 font-semibold text-text-light dark:text-text-dark mb-2" for="last_name">
<i class="material-icons">person</i>
                    ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:
                </label>
<input class="w-full rounded-md border-gray-300 dark:border-indigo-900 bg-white dark:bg-indigo-900/50 text-gray-700 dark:text-indigo-200 focus:border-primary focus:ring-primary" id="last_name" name="last_name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏à‡∏î‡∏µ" required="" type="text"/>
</div>
<div>
<label class="flex items-center gap-2 font-semibold text-text-light dark:text-text-dark mb-2" for="phone">
<i class="material-icons">phone</i>
                    ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡πà‡∏ß‡∏ô):
                </label>
<input class="w-full rounded-md border-gray-300 dark:border-indigo-900 bg-white dark:bg-indigo-900/50 text-gray-700 dark:text-indigo-200 focus:border-primary focus:ring-primary" id="phone" name="phone" placeholder="‡πÄ‡∏ä‡πà‡∏ô 081-234-5678" required="" type="tel"/>
</div>
<button class="submit-btn w-full bg-primary text-white font-bold py-3 px-4 rounded-full hover:bg-violet-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-background-dark transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center gap-2" type="submit">
<i class="material-icons">check_circle</i>
                ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡∏°‡∏≤‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô‡∏ô‡∏∞!)
            </button>
</form>
<div class="mt-6 p-4 bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-300 rounded-lg flex items-center justify-center gap-3" id="login-message">
<i class="material-icons animate-spin">sync</i>
<p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LIFF ‡πÅ‡∏•‡∏∞‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô...</p>
</div>
<hr class="my-8 border-gray-300 dark:border-indigo-800"/>
<div class="space-y-6">
<div>
<h2 class="text-2xl font-bold text-text-light dark:text-text-dark flex items-center justify-center gap-2 mb-4">
<i class="material-icons text-primary">favorite</i>
                    ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                </h2>
<ul class="space-y-3 text-left" id="guestList"></ul>
</div>
<div>
<h2 class="text-2xl font-bold text-text-light dark:text-text-dark flex items-center justify-center gap-2 mb-4">
<i class="material-icons text-primary">groups</i>
                    ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Ç‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </h2>
<div class="flex flex-col sm:flex-row justify-center gap-4 mb-4">
<button class="bg-primary/10 dark:bg-primary/20 text-primary dark:text-indigo-200 font-semibold py-2 px-6 rounded-full hover:bg-primary/20 dark:hover:bg-primary/30 transition" onclick="viewAllGuests('3-oct')">‡∏ß‡∏±‡∏ô‡∏ã‡πâ‡∏≠‡∏° (3 ‡∏ï.‡∏Ñ.)</button>
<button class="bg-primary/10 dark:bg-primary/20 text-primary dark:text-indigo-200 font-semibold py-2 px-6 rounded-full hover:bg-primary/20 dark:hover:bg-primary/30 transition" onclick="viewAllGuests('7-oct')">‡∏ß‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á (7 ‡∏ï.‡∏Ñ.)</button>
</div>
<p class="text-subtext-light dark:text-subtext-dark min-h-[1.5rem]" id="all-guest-status"></p>
<ul class="space-y-3 text-left mt-4" id="allGuestsList"></ul>
</div>
</div>
</div>
<script>
        // LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (2008162847-jMMzgOn1)
        const liffId = '2008162847-jMMzgOn1';
        let myUserId = '';
        let myName = ''; // ‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
        let myPictureUrl = '';
        // URL ‡∏Ç‡∏≠‡∏á Backend API ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const apiBaseUrl = 'https://website-degree-bn.onrender.com';
        //const apiBaseUrl = 'http://localhost:5000';
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        function updateStatus(elementId, message, color = 'black') {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `<p>${message}</p>`; // Wrap in p for consistency
                element.style.color = color;
            }
        }
        // ===================================
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£ (Schedule)
        // ===================================
        function displaySchedule(dateValue) {
            const scheduleDisplay = document.getElementById('schedule-display');
            const arrivalTimeGroup = document.getElementById('arrival-time-group');
            let title = '';
            let content = '';
            if (dateValue === '3-oct') {
                title = 'üóìÔ∏è ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ã‡πâ‡∏≠‡∏° (3 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°)';
                content = `
                    <p class="flex items-start gap-2"><span class="font-bold text-indigo-700 dark:text-indigo-300 w-28 shrink-0">07:00 - 10:45 ‡∏ô.</span> <span>‡∏ù‡∏∂‡∏Å‡∏ã‡πâ‡∏≠‡∏°‡∏¢‡πà‡∏≠‡∏¢/‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</span></p>
                    <p class="flex items-start gap-2"><span class="font-bold text-indigo-700 dark:text-indigo-300 w-28 shrink-0">11:30 - 13:30 ‡∏ô.</span> <span>‡∏ù‡∏∂‡∏Å‡∏ã‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏ö‡∏ô‡πÄ‡∏ß‡∏ó‡∏µ</span></p>
                    <p class="flex items-start gap-2"><span class="font-bold text-indigo-700 dark:text-indigo-300 w-28 shrink-0">14:00 - 20:00 ‡∏ô.</span> <span>‡∏ù‡∏∂‡∏Å‡∏ã‡πâ‡∏≠‡∏°‡πÉ‡∏´‡∏ç‡πà</span></p>
                    <p class="mt-3 font-semibold text-red-600 dark:text-red-400">* ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏≤‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ö‡πà‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ‡∏Ñ‡∏£‡∏±‡∏ö</p>
                `;
                scheduleDisplay.className = 'rounded-lg p-4 bg-blue-100 dark:bg-blue-900/50 border-l-4 border-blue-500 text-blue-800 dark:text-blue-200 space-y-2';
                scheduleDisplay.style.display = 'block';
                arrivalTimeGroup.style.display = 'block';
            } else if (dateValue === '7-oct') {
                title = 'üéì ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á (7 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°)';
                content = `
                    <p class="flex items-start gap-2"><span class="font-bold text-indigo-700 dark:text-indigo-300 w-28 shrink-0">08:00 - 11:00 ‡∏ô.</span> <span>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô/‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏°‡∏π‡πà/‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß</span></p>
                    <p class="flex items-start gap-2"><span class="font-bold text-indigo-700 dark:text-indigo-300 w-28 shrink-0">11:00 ‡∏ô. ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ</span> <span>‡∏û‡∏¥‡∏ò‡∏µ‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ó‡∏≤‡∏ô‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ö‡∏±‡∏ï‡∏£</span></p>
                    <p class="mt-3 font-semibold text-red-600 dark:text-red-400">* ‡πÇ‡∏õ‡∏£‡∏î‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡πà‡∏≠‡∏ô 10:30 ‡∏ô. ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô</p>
                `;
                scheduleDisplay.className = 'rounded-lg p-4 bg-green-100 dark:bg-green-900/50 border-l-4 border-green-500 text-green-800 dark:text-green-200 space-y-2';
                scheduleDisplay.style.display = 'block';
                arrivalTimeGroup.style.display = 'block';
            } else {
                scheduleDisplay.style.display = 'none';
                arrivalTimeGroup.style.display = 'none';
                document.getElementById('arrival_time').removeAttribute('required');
                return;
            }
            document.getElementById('arrival_time').setAttribute('required', 'required');
            scheduleDisplay.innerHTML = `
                <h3 class="font-bold text-lg mb-2">${title}</h3>
                ${content}
            `;
        }
        document.getElementById('date').addEventListener('change', (event) => {
            displaySchedule(event.target.value);
        });
        async function initializeLiff() {
            try {
                await liff.init({ liffId: liffId });
                if (!liff.isLoggedIn()) {
                    liff.login();
                } else {
                    const profile = await liff.getProfile();
                    myUserId = profile.userId;
                    myName = profile.displayName;
                    myPictureUrl = profile.pictureUrl;
                    document.getElementById('login-message').style.display = 'none';
                    document.getElementById('user-info').style.display = 'block';
                    document.getElementById('user-name').textContent = myName;
                    loadMyGuests(myName);
                    document.getElementById('registration-form').addEventListener('submit', handleFormSubmit);
                }
            } catch (err) {
                updateStatus('login-message', `‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LIFF ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${err.message}`, 'red');
            }
        }
        async function handleFormSubmit(event) {
            event.preventDefault();
            const submitBtn = event.target.querySelector('.submit-btn');
            submitBtn.innerHTML = '<i class="material-icons animate-spin">sync</i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            submitBtn.disabled = true;
            const form = event.target;
            const formData = new FormData(form);
            const payload = {
                line_user_id: myUserId,
                host_name: myName,
                first_name: formData.get('first_name'),
                last_name: formData.get('last_name'),
                phone: formData.get('phone'),
                date: formData.get('date'),
                arrival_time: formData.get('arrival_time')
            };
            try {
                const response = await fetch(`${apiBaseUrl}/api/guests`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                });
                if (response.ok) {
                    alert('‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏°‡∏≤‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡∏∞ üòä');
                    form.reset();
                    displaySchedule('');
                    loadMyGuests(myName);
                } else {
                    const errorData = await response.json();
                    alert(`‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${errorData.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î'}`);
                }
            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå');
            } finally {
                submitBtn.innerHTML = '<i class="material-icons">check_circle</i> ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡∏°‡∏≤‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô‡∏ô‡∏∞!)';
                submitBtn.disabled = false;
            }
        }
        async function loadMyGuests(hostName) {
            try {
                const response = await fetch(`${apiBaseUrl}/api/guests/by-host/${hostName}`);
                const guests = await response.json();
                const guestListElement = document.getElementById('guestList');
                guestListElement.innerHTML = '';
                if (guests.length === 0) {
                    guestListElement.innerHTML = '<li class="text-center text-gray-500 dark:text-gray-400 italic p-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏¢</li>';
                    return;
                }
                guests.forEach(guest => {
                    const listItem = document.createElement('li');
                    listItem.className = 'bg-card-light dark:bg-indigo-900/50 border border-gray-200 dark:border-indigo-800 p-3 rounded-lg flex justify-between items-center';
                    const dateText = guest.date === '3-oct' ? '‡∏ß‡∏±‡∏ô‡∏ã‡πâ‡∏≠‡∏° (3 ‡∏ï.‡∏Ñ.)' : '‡∏ß‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á (7 ‡∏ï.‡∏Ñ.)';
                    const arrivalTimeText = guest.arrival_time ? ` | ‚è±Ô∏è ${guest.arrival_time}` : '';
                    listItem.innerHTML = `
                        <div class="flex-grow">
                            <strong class="text-text-light dark:text-text-dark">${guest.first_name} ${guest.last_name}</strong>
                            <small class="block text-primary dark:text-indigo-300 font-semibold">${dateText} ${arrivalTimeText}</small>
                            ${guest.phone ? `<small class="block text-gray-500 dark:text-gray-400">üìû ${guest.phone}</small>` : ''}
                        </div>
                        <button class="delete-btn bg-red-500 text-white rounded-full p-2 hover:bg-red-600 transition" onclick="deleteGuest('${guest.id}', '${guest.first_name} ${guest.last_name}')">
                            <i class="material-icons text-base">delete</i>
                        </button>
                    `;
                    guestListElement.appendChild(listItem);
                });
            } catch (error) {
                document.getElementById('guestList').innerHTML = '<li class="text-center text-red-500 italic p-4">‚ùå ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</li>';
            }
        }
        async function deleteGuest(guestId, guestName) {
            if (!confirm(`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö: ${guestName} ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£?`)) return;
            try {
                const response = await fetch(`${apiBaseUrl}/api/guests/${guestId}`, { method: 'DELETE' });
                if (response.ok) {
                    alert(`${guestName} ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß`);
                    loadMyGuests(myName);
                } else {
                    alert('‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                }
            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå');
            }
        }
        async function viewAllGuests(dateValue) {
            const allGuestsListElement = document.getElementById('allGuestsList');
            const allGuestStatus = document.getElementById('all-guest-status');
            allGuestsListElement.innerHTML = '';
            allGuestStatus.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠...';
            try {
                const dateText = dateValue === '3-oct' ? '3 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° (‡∏ß‡∏±‡∏ô‡∏ã‡πâ‡∏≠‡∏°)' : '7 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° (‡∏ß‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á)';
                const response = await fetch(`${apiBaseUrl}/api/guests/by-date/${dateValue}`);
                const guests = await response.json();
                allGuestStatus.textContent = `‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô ${dateText}`;
                if (guests.length === 0) {
                    allGuestsListElement.innerHTML = '<li class="text-center text-gray-500 dark:text-gray-400 italic p-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</li>';
                    return;
                }
                guests.forEach(guest => {
                    const listItem = document.createElement('li');
                    listItem.className = 'bg-card-light dark:bg-indigo-900/50 border border-gray-200 dark:border-indigo-800 p-3 rounded-lg';
                    const arrivalTimeText = guest.arrival_time ? ` | ‚è±Ô∏è ${guest.arrival_time}` : '';
                    listItem.innerHTML = `
                        <strong class="text-text-light dark:text-text-dark">${guest.first_name} ${guest.last_name}</strong>
                        <small class="block text-primary dark:text-indigo-300 font-semibold">(‡∏°‡∏≤‡∏Å‡∏±‡∏ö ${guest.host_name}) ${arrivalTimeText}</small>
                    `;
                    allGuestsListElement.appendChild(listItem);
                });
            } catch (error) {
                allGuestStatus.textContent = '‚ùå ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Ç‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
            }
        }
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof liff !== 'undefined') {
                initializeLiff();
            } else {
                // Mockup for testing in browser
                document.getElementById('login-message').innerHTML = '<p class="text-orange-600 dark:text-orange-400">‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö LIFF SDK ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</p>';
                myUserId = 'Umockup_line_id_12345';
                myName = 'Test User (Mock)';
                document.getElementById('user-info').style.display = 'block';
                document.getElementById('user-name').textContent = myName;
                document.getElementById('registration-form').addEventListener('submit', handleFormSubmit);
                loadMyGuests(myName);
            }
        });
    </script>

</body></html>
